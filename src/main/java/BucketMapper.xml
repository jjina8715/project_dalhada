<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="resource.BucketMapper">
 	<select id="detailBucket"  resultType="vo.BucketDetailVO" parameterType="_int">
		select Sb.id, Sb.title, Sb.content, Sb.lat, Sb.lng, Bi.image, Bi.cnt
				, Mi.member_id as by_member_id, Mi.image, Sb.member_id as get_member_id, 
				(select count(*)
    				from likeinfo
    				where bucket_id = #{id}) as likecnt
    	from bucketinfo Bi, selectedBucket Sb, memberinfo Mi
    	where Bi.id = Sb.bucket_id AND Sb.id = #{id} AND Mi.id = Bi.member_id 
 	</select>
 	<select id="bucketTags" resultType="list" parameterType="_int">
 		select T.name
 		from taginfo T, selectedtag St
 		where St.bucket_id = #{id} AND T.id = St.tag_id
 	</select>
	<select id="selectADBucket" resultType="List">
		select Sb.title, image, id
		from bucketinfo B, selectedBucket Sb
		where B.id = Sb.bucket_id
	</select>
</mapper>